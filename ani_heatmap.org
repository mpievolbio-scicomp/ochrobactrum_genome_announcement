#+name: ANI heatmap
#+author: Carsten Fortmann-Grote (@CFGrote)
#+date: [2025-12-11 Thu] 
#+property:header-args:R :results output :tangle fastani_heatmap.R :noweb yes :eval yes :session rbioinfo


* Libraries
:PROPERTIES:
:ID:       206c49a5-a191-4f73-9f27-bc35a6d1498b
:END:
#+name: libraries
#+begin_src R :results quiet :session rbioinfo
  library('ggcorrheatmap')
  library('reshape2')
  library('ggplot2')
#+end_src

#+RESULTS: libraries
| ggplot2       |
| reshape2      |
| ggcorrheatmap |
| stats         |
| graphics      |
| grDevices     |
| utils         |
| datasets      |
| methods       |
| base          |

* Data massage
:PROPERTIES:
:ID:       35471fb5-7cb3-459d-a6a8-b999e734cacb
:END:
** Original data
:PROPERTIES:
:ID:       aa04eaa7-59a6-40f6-bc89-16d3e4c6dc6c
:END:
| QUERY                       | REFERENCE                   | ANI_ESTIMATE |
|-----------------------------+-----------------------------+--------------|
| O.pituitosum NV9            | P.saccharolyticum CCUG33852 |      77.5564 |
| O.pituitosum NV9            | P.saccharolyticum DSM25260  |      77.5571 |
| P.saccharolyticum DSM25260  | O.pituitosum NV9            |      77.5934 |
| P.saccharolyticum DSM25260  | O.pituitosum PH15           |      77.5965 |
| Pseudochrobactrum IV4       | B.pituitosa BU72            |      77.6148 |
| P.saccharolyticum CCUG33852 | O.pituitosum NV9            |      77.6243 |
| P.saccharolyticum CCUG33852 | O.pituitosum PH15           |      77.6272 |
| P.saccharolyticum DSM25260  | O.pituitosum IV11           |      77.6331 |
| P.saccharolyticum DSM25260  | O.pituitosum CCUG50899      |      77.6428 |
| P.saccharolyticum DSM25260  | O.pituitosum PH4            |        77.65 |
| P.saccharolyticum DSM25260  | O.pituitosum NH1            |      77.6545 |
| P.saccharolyticum DSM25260  | B.pituitosa BU72            |      77.6575 |
| O.pituitosum PH4            | P.saccharolyticum DSM25260  |      77.6628 |
| Pseudochrobactrum IV4       | O.pituitosum IV11           |       77.666 |
| P.saccharolyticum CCUG33852 | O.pituitosum NH1            |      77.6827 |
| O.pituitosum IV11           | P.saccharolyticum DSM25260  |      77.6869 |
| O.pituitosum IV11           | Pseudochrobactrum NH11      |       77.687 |
| P.saccharolyticum CCUG33852 | O.pituitosum IV11           |      77.6927 |
| O.pituitosum NH1            | P.saccharolyticum DSM25260  |      77.6982 |
| B.pituitosa BU72            | P.saccharolyticum DSM25260  |      77.7082 |
| O.pituitosum PH4            | P.saccharolyticum CCUG33852 |        77.72 |
| B.pituitosa BU72            | Pseudochrobactrum NH11      |      77.7227 |
| P.saccharolyticum CCUG33852 | B.pituitosa BU72            |      77.7238 |
| O.pituitosum IV11           | P.saccharolyticum CCUG33852 |      77.7345 |
| O.pituitosum CCUG50899      | P.saccharolyticum DSM25260  |      77.7393 |
| O.pituitosum NH1            | P.saccharolyticum CCUG33852 |      77.7447 |
| O.pituitosum PH15           | P.saccharolyticum DSM25260  |      77.7483 |
| Pseudochrobactrum NH11      | O.pituitosum CCUG50899      |      77.7538 |
| B.pituitosa BU72            | Pseudochrobactrum IV4       |      77.7613 |
| B.pituitosa BU72            | P.saccharolyticum CCUG33852 |      77.7657 |
| O.pituitosum CCUG50899      | P.saccharolyticum CCUG33852 |      77.7897 |
| P.saccharolyticum CCUG33852 | O.pituitosum CCUG50899      |      77.8055 |
| P.saccharolyticum CCUG33852 | O.pituitosum PH4            |      77.8086 |
| O.pituitosum PH4            | Pseudochrobactrum IV4       |       77.812 |
| Pseudochrobactrum NH11      | B.pituitosa BU72            |      77.8143 |
| O.pituitosum PH15           | P.saccharolyticum CCUG33852 |      77.8224 |
| O.pituitosum PH4            | Pseudochrobactrum PH5       |      77.8335 |
| B.pituitosa BU72            | Pseudochrobactrum PH5       |      77.8382 |
| Pseudochrobactrum IV4       | O.pituitosum NH1            |      77.8428 |
| Pseudochrobactrum NH11      | O.pituitosum IV11           |      77.8508 |
| Pseudochrobactrum IV4       | O.pituitosum PH4            |      77.8561 |
| O.pituitosum NV9            | Pseudochrobactrum NH11      |      77.8864 |
| O.pituitosum PH4            | Pseudochrobactrum NH11      |      77.8956 |
| O.pituitosum NV9            | Pseudochrobactrum IV4       |      77.9136 |
| O.pituitosum NH1            | Pseudochrobactrum NH11      |      77.9164 |
| Pseudochrobactrum NH11      | O.pituitosum NV9            |      77.9248 |
| Pseudochrobactrum IV4       | O.pituitosum CCUG50899      |      77.9249 |
| O.pituitosum NV9            | Pseudochrobactrum PH5       |      77.9257 |
| Pseudochrobactrum IV4       | O.pituitosum NV9            |      77.9291 |
| Pseudochrobactrum IV4       | O.pituitosum PH15           |      77.9371 |
| Pseudochrobactrum NH11      | O.pituitosum PH4            |      77.9646 |
| Pseudochrobactrum PH5       | B.pituitosa BU72            |      77.9756 |
| Pseudochrobactrum NH11      | O.pituitosum PH15           |      77.9761 |
| O.pituitosum IV11           | Pseudochrobactrum PH5       |      78.0064 |
| O.pituitosum CCUG50899      | Pseudochrobactrum NH11      |      78.0117 |
| Pseudochrobactrum PH5       | O.pituitosum CCUG50899      |      78.0307 |
| O.pituitosum IV11           | Pseudochrobactrum IV4       |      78.0328 |
| O.pituitosum PH15           | Pseudochrobactrum NH11      |      78.0359 |
| Pseudochrobactrum PH5       | O.pituitosum IV11           |      78.0393 |
| Pseudochrobactrum NH11      | O.pituitosum NH1            |       78.042 |
| O.pituitosum NH1            | Pseudochrobactrum IV4       |       78.048 |
| Pseudochrobactrum PH5       | O.pituitosum PH4            |      78.0613 |
| Pseudochrobactrum PH5       | O.pituitosum NV9            |      78.0892 |
| O.pituitosum CCUG50899      | Pseudochrobactrum IV4       |       78.091 |
| O.pituitosum CCUG50899      | Pseudochrobactrum PH5       |      78.1151 |
| O.pituitosum PH15           | Pseudochrobactrum IV4       |      78.1668 |
| O.pituitosum NH1            | Pseudochrobactrum PH5       |      78.3472 |
| Pseudochrobactrum PH5       | O.pituitosum NH1            |       78.509 |
| O.pituitosum PH15           | Pseudochrobactrum PH5       |      78.5989 |
| Pseudochrobactrum PH5       | O.pituitosum PH15           |       78.639 |
| Pseudochrobactrum PH5       | Pseudochrobactrum NH11      |      96.1482 |
| Pseudochrobactrum IV4       | Pseudochrobactrum NH11      |      96.1565 |
| Pseudochrobactrum NH11      | Pseudochrobactrum PH5       |      96.1675 |
| Pseudochrobactrum NH11      | Pseudochrobactrum IV4       |      96.1811 |
| P.saccharolyticum DSM25260  | Pseudochrobactrum PH5       |      96.1847 |
| P.saccharolyticum CCUG33852 | Pseudochrobactrum PH5       |      96.2042 |
| Pseudochrobactrum PH5       | P.saccharolyticum DSM25260  |      96.2186 |
| Pseudochrobactrum PH5       | P.saccharolyticum CCUG33852 |      96.2202 |
| Pseudochrobactrum IV4       | P.saccharolyticum DSM25260  |      96.2722 |
| P.saccharolyticum CCUG33852 | Pseudochrobactrum IV4       |      96.2783 |
| P.saccharolyticum DSM25260  | Pseudochrobactrum IV4       |      96.2921 |
| Pseudochrobactrum IV4       | P.saccharolyticum CCUG33852 |      96.2934 |
| Pseudochrobactrum IV4       | Pseudochrobactrum PH5       |      96.3125 |
| P.saccharolyticum CCUG33852 | Pseudochrobactrum NH11      |      96.3288 |
| P.saccharolyticum DSM25260  | Pseudochrobactrum NH11      |      96.3453 |
| Pseudochrobactrum PH5       | Pseudochrobactrum IV4       |       96.354 |
| Pseudochrobactrum NH11      | P.saccharolyticum CCUG33852 |      96.3568 |
| Pseudochrobactrum NH11      | P.saccharolyticum DSM25260  |      96.3628 |
| O.pituitosum CCUG50899      | O.pituitosum IV11           |      97.9973 |
| O.pituitosum IV11           | O.pituitosum CCUG50899      |      98.0089 |
| O.pituitosum IV11           | B.pituitosa BU72            |      98.0453 |
| B.pituitosa BU72            | O.pituitosum IV11           |      98.0585 |
| O.pituitosum IV11           | O.pituitosum PH4            |      98.1054 |
| O.pituitosum PH4            | O.pituitosum IV11           |       98.145 |
| O.pituitosum CCUG50899      | O.pituitosum PH15           |      98.2591 |
| B.pituitosa BU72            | O.pituitosum PH15           |      98.2681 |
| O.pituitosum PH15           | B.pituitosa BU72            |      98.2837 |
| B.pituitosa BU72            | O.pituitosum CCUG50899      |      98.2929 |
| O.pituitosum CCUG50899      | B.pituitosa BU72            |       98.299 |
| B.pituitosa BU72            | O.pituitosum NV9            |      98.3015 |
| O.pituitosum PH4            | O.pituitosum PH15           |      98.3028 |
| O.pituitosum CCUG50899      | O.pituitosum PH4            |      98.3142 |
| O.pituitosum PH15           | O.pituitosum CCUG50899      |      98.3143 |
| O.pituitosum PH15           | O.pituitosum PH4            |      98.3511 |
| O.pituitosum PH4            | O.pituitosum CCUG50899      |      98.3591 |
| O.pituitosum NV9            | B.pituitosa BU72            |       98.371 |
| B.pituitosa BU72            | O.pituitosum NH1            |      98.3927 |
| O.pituitosum PH4            | B.pituitosa BU72            |      98.4017 |
| B.pituitosa BU72            | O.pituitosum PH4            |      98.4023 |
| O.pituitosum NH1            | B.pituitosa BU72            |      98.4628 |
| O.pituitosum NV9            | O.pituitosum PH4            |      98.4828 |
| O.pituitosum NH1            | O.pituitosum CCUG50899      |      98.4997 |
| O.pituitosum PH4            | O.pituitosum NV9            |      98.5013 |
| O.pituitosum NH1            | O.pituitosum PH4            |      98.5104 |
| O.pituitosum PH4            | O.pituitosum NH1            |      98.5197 |
| O.pituitosum CCUG50899      | O.pituitosum NH1            |      98.5216 |
| O.pituitosum NV9            | O.pituitosum CCUG50899      |      98.5265 |
| O.pituitosum CCUG50899      | O.pituitosum NV9            |      98.5303 |
| O.pituitosum IV11           | O.pituitosum NH1            |      98.6263 |
| O.pituitosum NH1            | O.pituitosum IV11           |      98.6391 |
| O.pituitosum IV11           | O.pituitosum PH15           |      98.7947 |
| O.pituitosum PH15           | O.pituitosum IV11           |      98.8264 |
| O.pituitosum IV11           | O.pituitosum NV9            |      98.8856 |
| O.pituitosum NV9            | O.pituitosum IV11           |      98.9332 |
| O.pituitosum NH1            | O.pituitosum PH15           |      98.9969 |
| O.pituitosum PH15           | O.pituitosum NH1            |      99.0194 |
| O.pituitosum NH1            | O.pituitosum NV9            |      99.2807 |
| O.pituitosum NV9            | O.pituitosum NH1            |      99.3008 |
| O.pituitosum NV9            | O.pituitosum PH15           |      99.6654 |
| O.pituitosum PH15           | O.pituitosum NV9            |      99.6718 |
| P.saccharolyticum CCUG33852 | P.saccharolyticum DSM25260  |      99.9972 |
| P.saccharolyticum DSM25260  | P.saccharolyticum CCUG33852 |      99.9992 |

** Massaged data
:PROPERTIES:
:ID:       7a0ffe4e-39db-489d-8d46-522c4147f10c
:END:
#+begin_src shell
  cat FastANI_Results.csv \
    | grep -v "CCUG33852" \
    | grep -v "BU72" \
    | grep -v "NV9" \
    | sed 's/IV11/MPB25535/g' \
    | sed 's/PH15/MPB25415/g' \
    | sed 's/PH4/MPB25440/g' \
    | sed 's/NH11/MPB25488/g' \
    | sed 's/NH1/MPB25478/g' \
    | sed 's/IV4/MPB25528/g' \
    | sed 's/PH5/MPB25441/g' \
    | sed 's/Pseudochrobactrum M/M/g' \
    | sed 's/O\.pituitosum M/M/g'  \
    | sed 's/O\.pituitosum/O.pit./g' \
    | sed 's/P\.saccharolyticum/P.sac./g' \
    > FastANI_Results_clean.csv
  cat FastANI_Results_clean.csv
#+end_src

#+RESULTS:
| QUERY            | REFERENCE        | ANI_ESTIMATE |
| P.sac. DSM25260  | MPB25415         |      77.5965 |
| P.sac. DSM25260  | MPB25535         |      77.6331 |
| P.sac. DSM25260  | O.pit. CCUG50899 |      77.6428 |
| P.sac. DSM25260  | MPB25440         |        77.65 |
| P.sac. DSM25260  | MPB25478         |      77.6545 |
| MPB25440         | P.sac. DSM25260  |      77.6628 |
| MPB25528         | MPB25535         |       77.666 |
| MPB25535         | P.sac. DSM25260  |      77.6869 |
| MPB25535         | MPB25488         |       77.687 |
| MPB25478         | P.sac. DSM25260  |      77.6982 |
| O.pit. CCUG50899 | P.sac. DSM25260  |      77.7393 |
| MPB25415         | P.sac. DSM25260  |      77.7483 |
| MPB25488         | O.pit. CCUG50899 |      77.7538 |
| MPB25440         | MPB25528         |       77.812 |
| MPB25440         | MPB25441         |      77.8335 |
| MPB25528         | MPB25478         |      77.8428 |
| MPB25488         | MPB25535         |      77.8508 |
| MPB25528         | MPB25440         |      77.8561 |
| MPB25440         | MPB25488         |      77.8956 |
| MPB25478         | MPB25488         |      77.9164 |
| MPB25528         | O.pit. CCUG50899 |      77.9249 |
| MPB25528         | MPB25415         |      77.9371 |
| MPB25488         | MPB25440         |      77.9646 |
| MPB25488         | MPB25415         |      77.9761 |
| MPB25535         | MPB25441         |      78.0064 |
| O.pit. CCUG50899 | MPB25488         |      78.0117 |
| MPB25441         | O.pit. CCUG50899 |      78.0307 |
| MPB25535         | MPB25528         |      78.0328 |
| MPB25415         | MPB25488         |      78.0359 |
| MPB25441         | MPB25535         |      78.0393 |
| MPB25488         | MPB25478         |       78.042 |
| MPB25478         | MPB25528         |       78.048 |
| MPB25441         | MPB25440         |      78.0613 |
| O.pit. CCUG50899 | MPB25528         |       78.091 |
| O.pit. CCUG50899 | MPB25441         |      78.1151 |
| MPB25415         | MPB25528         |      78.1668 |
| MPB25478         | MPB25441         |      78.3472 |
| MPB25441         | MPB25478         |       78.509 |
| MPB25415         | MPB25441         |      78.5989 |
| MPB25441         | MPB25415         |       78.639 |
| MPB25441         | MPB25488         |      96.1482 |
| MPB25528         | MPB25488         |      96.1565 |
| MPB25488         | MPB25441         |      96.1675 |
| MPB25488         | MPB25528         |      96.1811 |
| P.sac. DSM25260  | MPB25441         |      96.1847 |
| MPB25441         | P.sac. DSM25260  |      96.2186 |
| MPB25528         | P.sac. DSM25260  |      96.2722 |
| P.sac. DSM25260  | MPB25528         |      96.2921 |
| MPB25528         | MPB25441         |      96.3125 |
| P.sac. DSM25260  | MPB25488         |      96.3453 |
| MPB25441         | MPB25528         |       96.354 |
| MPB25488         | P.sac. DSM25260  |      96.3628 |
| O.pit. CCUG50899 | MPB25535         |      97.9973 |
| MPB25535         | O.pit. CCUG50899 |      98.0089 |
| MPB25535         | MPB25440         |      98.1054 |
| MPB25440         | MPB25535         |       98.145 |
| O.pit. CCUG50899 | MPB25415         |      98.2591 |
| MPB25440         | MPB25415         |      98.3028 |
| O.pit. CCUG50899 | MPB25440         |      98.3142 |
| MPB25415         | O.pit. CCUG50899 |      98.3143 |
| MPB25415         | MPB25440         |      98.3511 |
| MPB25440         | O.pit. CCUG50899 |      98.3591 |
| MPB25478         | O.pit. CCUG50899 |      98.4997 |
| MPB25478         | MPB25440         |      98.5104 |
| MPB25440         | MPB25478         |      98.5197 |
| O.pit. CCUG50899 | MPB25478         |      98.5216 |
| MPB25535         | MPB25478         |      98.6263 |
| MPB25478         | MPB25535         |      98.6391 |
| MPB25535         | MPB25415         |      98.7947 |
| MPB25415         | MPB25535         |      98.8264 |
| MPB25478         | MPB25415         |      98.9969 |
| MPB25415         | MPB25478         |      99.0194 |

* Load data
:PROPERTIES:
:ID:       6461c9a0-45f0-4e7d-8264-da42dd7e7d27
:END:

#+begin_src R :session rbioinfo
  data <- read.csv("FastANI_Results_clean.csv", stringsAsFactors = FALSE)
#+end_src

#+RESULTS:
| P.sac. DSM25260  | MPB25415         | 77.5965 |
| P.sac. DSM25260  | MPB25535         | 77.6331 |
| P.sac. DSM25260  | O.pit. CCUG50899 | 77.6428 |
| P.sac. DSM25260  | MPB25440         |   77.65 |
| P.sac. DSM25260  | MPB25478         | 77.6545 |
| MPB25440         | P.sac. DSM25260  | 77.6628 |
| MPB25528         | MPB25535         |  77.666 |
| MPB25535         | P.sac. DSM25260  | 77.6869 |
| MPB25535         | MPB25488         |  77.687 |
| MPB25478         | P.sac. DSM25260  | 77.6982 |
| O.pit. CCUG50899 | P.sac. DSM25260  | 77.7393 |
| MPB25415         | P.sac. DSM25260  | 77.7483 |
| MPB25488         | O.pit. CCUG50899 | 77.7538 |
| MPB25440         | MPB25528         |  77.812 |
| MPB25440         | MPB25441         | 77.8335 |
| MPB25528         | MPB25478         | 77.8428 |
| MPB25488         | MPB25535         | 77.8508 |
| MPB25528         | MPB25440         | 77.8561 |
| MPB25440         | MPB25488         | 77.8956 |
| MPB25478         | MPB25488         | 77.9164 |
| MPB25528         | O.pit. CCUG50899 | 77.9249 |
| MPB25528         | MPB25415         | 77.9371 |
| MPB25488         | MPB25440         | 77.9646 |
| MPB25488         | MPB25415         | 77.9761 |
| MPB25535         | MPB25441         | 78.0064 |
| O.pit. CCUG50899 | MPB25488         | 78.0117 |
| MPB25441         | O.pit. CCUG50899 | 78.0307 |
| MPB25535         | MPB25528         | 78.0328 |
| MPB25415         | MPB25488         | 78.0359 |
| MPB25441         | MPB25535         | 78.0393 |
| MPB25488         | MPB25478         |  78.042 |
| MPB25478         | MPB25528         |  78.048 |
| MPB25441         | MPB25440         | 78.0613 |
| O.pit. CCUG50899 | MPB25528         |  78.091 |
| O.pit. CCUG50899 | MPB25441         | 78.1151 |
| MPB25415         | MPB25528         | 78.1668 |
| MPB25478         | MPB25441         | 78.3472 |
| MPB25441         | MPB25478         |  78.509 |
| MPB25415         | MPB25441         | 78.5989 |
| MPB25441         | MPB25415         |  78.639 |
| MPB25441         | MPB25488         | 96.1482 |
| MPB25528         | MPB25488         | 96.1565 |
| MPB25488         | MPB25441         | 96.1675 |
| MPB25488         | MPB25528         | 96.1811 |
| P.sac. DSM25260  | MPB25441         | 96.1847 |
| MPB25441         | P.sac. DSM25260  | 96.2186 |
| MPB25528         | P.sac. DSM25260  | 96.2722 |
| P.sac. DSM25260  | MPB25528         | 96.2921 |
| MPB25528         | MPB25441         | 96.3125 |
| P.sac. DSM25260  | MPB25488         | 96.3453 |
| MPB25441         | MPB25528         |  96.354 |
| MPB25488         | P.sac. DSM25260  | 96.3628 |
| O.pit. CCUG50899 | MPB25535         | 97.9973 |
| MPB25535         | O.pit. CCUG50899 | 98.0089 |
| MPB25535         | MPB25440         | 98.1054 |
| MPB25440         | MPB25535         |  98.145 |
| O.pit. CCUG50899 | MPB25415         | 98.2591 |
| MPB25440         | MPB25415         | 98.3028 |
| O.pit. CCUG50899 | MPB25440         | 98.3142 |
| MPB25415         | O.pit. CCUG50899 | 98.3143 |
| MPB25415         | MPB25440         | 98.3511 |
| MPB25440         | O.pit. CCUG50899 | 98.3591 |
| MPB25478         | O.pit. CCUG50899 | 98.4997 |
| MPB25478         | MPB25440         | 98.5104 |
| MPB25440         | MPB25478         | 98.5197 |
| O.pit. CCUG50899 | MPB25478         | 98.5216 |
| MPB25535         | MPB25478         | 98.6263 |
| MPB25478         | MPB25535         | 98.6391 |
| MPB25535         | MPB25415         | 98.7947 |
| MPB25415         | MPB25535         | 98.8264 |
| MPB25478         | MPB25415         | 98.9969 |
| MPB25415         | MPB25478         | 99.0194 |

# Step 2: Reshape the data into a wide format using dcast
# We need to make the QUERY values the row names and the REFERENCE values the column names
#+begin_src R :session rbioinfo
data_matrix <- dcast(data, QUERY ~ REFERENCE, value.var = "ANI_ESTIMATE")
#+end_src

#+RESULTS:
| MPB25415         |         | 98.3511 | 78.5989 | 99.0194 | 78.0359 | 78.1668 | 98.8264 | 98.3143 | 77.7483 |
| MPB25440         | 98.3028 |         | 77.8335 | 98.5197 | 77.8956 |  77.812 |  98.145 | 98.3591 | 77.6628 |
| MPB25441         |  78.639 | 78.0613 |         |  78.509 | 96.1482 |  96.354 | 78.0393 | 78.0307 | 96.2186 |
| MPB25478         | 98.9969 | 98.5104 | 78.3472 |         | 77.9164 |  78.048 | 98.6391 | 98.4997 | 77.6982 |
| MPB25488         | 77.9761 | 77.9646 | 96.1675 |  78.042 |         | 96.1811 | 77.8508 | 77.7538 | 96.3628 |
| MPB25528         | 77.9371 | 77.8561 | 96.3125 | 77.8428 | 96.1565 |         |  77.666 | 77.9249 | 96.2722 |
| MPB25535         | 98.7947 | 98.1054 | 78.0064 | 98.6263 |  77.687 | 78.0328 |         | 98.0089 | 77.6869 |
| O.pit. CCUG50899 | 98.2591 | 98.3142 | 78.1151 | 98.5216 | 78.0117 |  78.091 | 97.9973 |         | 77.7393 |
| P.sac. DSM25260  | 77.5965 |   77.65 | 96.1847 | 77.6545 | 96.3453 | 96.2921 | 77.6331 | 77.6428 |         |
#+begin_src R :session rbioinfo
heatmap_data <- as.matrix(data_matrix[, -1])  # Remove the QUERY column which is now row names
## heatmap_data[is.na(heatmap_data)] <- 100.0
heatmap_data <- heatmap_data * 0.01
rownames(heatmap_data) <- data_matrix$QUERY  # Set QUERY as row names
#+end_src

#+RESULTS:
| MPB25415         |
| MPB25440         |
| MPB25441         |
| MPB25478         |
| MPB25488         |
| MPB25528         |
| MPB25535         |
| O.pit. CCUG50899 |
| P.sac. DSM25260  |



#+begin_src R :session rbioinfo :results output file link :file ani_heatmap.png
  # Plot heatmap
  gghm(heatmap_data,
       layout='topleft',
       col_scale='YlGnBu',
       bins=5,
       na_remove=TRUE,
       cell_labels=TRUE,
       cluster_rows=TRUE,
       cluster_cols=TRUE,
       show_dend_rows=FALSE,
       show_dend_cols=FALSE,
       cell_label_digits=3,
       dend_height=0.0,
       legend_order=NA,
       cell_label_size=6,
       ## show_names_diag=TRUE,
       ## names_diag_params=list(angle=-45)
       ) + theme(axis.text.x = element_text(size=18), axis.text.y = element_text(size=18))
  ggsave('ani_heatmap.pdf', dpi=600)
  ggsave('ani_heatmap.png', dpi=150)
#+end_src

#+RESULTS:
[[file:ani_heatmap.png]]




